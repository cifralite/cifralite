@page "/musicas/{id:int}"
@inject MusicaService MusicaService

<NavBar/>
<div id=main>
@* <BarraDeBusca Titulo="Barra De Pesquisa de Musica"></BarraDeBusca> *@

    <section id="infoMusicas">
        <div id="nomeMusica" class="blocoMusica">
            <span id="titulo">@musicas[id-1].Titulo</span>
        </div>
        <div class="tomMusica">
            <span id="tom" class="blocoMusica">@musicas[id-1].Tom</span>
            <div class="responsivoAumentarDiminuir">
                <p id="aumentarTom" class="blocoMusica">+</p>
                <p id="diminuirTom" class="blocoMusica">-</p>
            </div>
        </div>
        <div class="blocoMusica" id="blocoLixeira">
            <img src="fotos/iconLixeixa.png" alt="icone lixeira" id="iconLixeira">
        </div>
        <div class="blocoMusica" id="blocoEditarMusica">
            <button>
                <img src="fotos/iconEditarMusica.png" alt="icone editar mÃºsica" id="iconEditarMusica">
            </button>
        </div>
    </section>
            
    @foreach (var secao in musicas[id-1].Secoes)
    {
        <div class="secoes">
            <section>
                <p id="TituloSecao">@secao.Titulo</p>
                <div class="Acordes">
                    @foreach (var acorde in secao.Acordes)
                    {    
                        <section class="notasContruidas">
                            <div class="tempo">@(ConstruirTempoEmTexto(acorde))</div>
                            <div class="notas">@(ConstruirNotaEmTexto(acorde))</div>
                        </section>
                    }
                </div>
            </section>
        </div>
    }

@* @foreach (var musica in musicas)
{
    <p style="color: whitesmoke;">Titulo: @musica.Titulo</p>

    foreach (var secao in musica.Secoes)
    {
        <p style="color: rgb(139, 122, 122);">@secao.Titulo</p>
        foreach (var acorde in secao.Acordes)
        {
            <span style="color: rgb(139, 122, 122);">@(ConstruirNotaEmTexto(acorde))</span>
        }
    }
} *@
</div>

@code {

    [Parameter]
    public int id { get; set; }

    private List<Musica> musicas = new List<Musica>();

    protected override void OnInitialized()
    {
        musicas = MusicaService.ObterMusicas();
    }

    private string ConstruirNotaEmTexto(Acorde acorde)
    {
        if (string.IsNullOrEmpty(acorde.Baixo))
        {
            return acorde.Nota;
        }

        return $"{acorde.Nota}/{acorde.Baixo}";
    }

    private string ConstruirTempoEmTexto(Acorde acorde)
    {
        int acordeTempoInt = acorde.Tempo;
        string acordeTempoString = acordeTempoInt.ToString();
        return acordeTempoString;
    }

}